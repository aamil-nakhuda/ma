<!DOCTYPE html>
<!-- saved from url=(0126)https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">
	<title>Practical Malware Analysis Lab12-2 – BufferOverflowed</title>
<meta name="robots" content="max-image-preview:large">
<link rel="dns-prefetch" href="https://s0.wp.com/">
<link rel="dns-prefetch" href="https://wordpress.com/">
<link rel="dns-prefetch" href="https://fonts-api.wp.com/">
<link rel="dns-prefetch" href="https://s.pubmine.com/">
<link rel="dns-prefetch" href="https://x.bidswitch.net/">
<link rel="dns-prefetch" href="https://static.criteo.net/">
<link rel="dns-prefetch" href="https://ib.adnxs.com/">
<link rel="dns-prefetch" href="https://aax.amazon-adsystem.com/">
<link rel="dns-prefetch" href="https://bidder.criteo.com/">
<link rel="dns-prefetch" href="https://cas.criteo.com/">
<link rel="dns-prefetch" href="https://gum.criteo.com/">
<link rel="dns-prefetch" href="https://ads.pubmatic.com/">
<link rel="dns-prefetch" href="https://gads.pubmatic.com/">
<link rel="dns-prefetch" href="https://tpc.googlesyndication.com/">
<link rel="dns-prefetch" href="https://ad.doubleclick.net/">
<link rel="dns-prefetch" href="https://googleads.g.doubleclick.net/">
<link rel="dns-prefetch" href="https://www.googletagservices.com/">
<link rel="dns-prefetch" href="https://cdn.switchadhub.com/">
<link rel="dns-prefetch" href="https://delivery.g.switchadhub.com/">
<link rel="dns-prefetch" href="https://delivery.swid.switchadhub.com/">
<link rel="dns-prefetch" href="https://a.teads.tv/">
<link rel="dns-prefetch" href="https://prebid.media.net/">
<link rel="dns-prefetch" href="https://adserver-us.adtech.advertising.com/">
<link rel="dns-prefetch" href="https://fastlane.rubiconproject.com/">
<link rel="dns-prefetch" href="https://prebid-server.rubiconproject.com/">
<link rel="dns-prefetch" href="https://hb-api.omnitagjs.com/">
<link rel="dns-prefetch" href="https://mtrx.go.sonobi.com/">
<link rel="dns-prefetch" href="https://apex.go.sonobi.com/">
<link rel="dns-prefetch" href="https://u.openx.net/">
<link rel="alternate" type="application/rss+xml" title="BufferOverflowed » Feed" href="https://bufferoverflowed.wordpress.com/feed/">
<link rel="alternate" type="application/rss+xml" title="BufferOverflowed » Comments Feed" href="https://bufferoverflowed.wordpress.com/comments/feed/">
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
	<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s0.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1719498190i&ver=6.6-RC1-58586"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-0-1" href="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/saved_resource(1)" type="text/css" media="all">
<style id="wp-emoji-styles-inline-css">

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-2-1" href="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/saved_resource(2)" type="text/css" media="all">
<style id="wp-block-library-inline-css">
.has-text-align-justify {
	text-align:justify;
}
.has-text-align-justify{text-align:justify;}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-4-1" href="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/saved_resource(3)" type="text/css" media="all">
<style id="jetpack-sharing-buttons-style-inline-css">
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-6-1" href="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/saved_resource(4)" type="text/css" media="all">
<style id="classic-theme-styles-inline-css">
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-8-1" href="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/saved_resource(5)" type="text/css" media="all">
<style id="global-styles-inline-css">
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--primary: #23883D;--wp--preset--color--secondary: #0963C4;--wp--preset--color--foreground: #111111;--wp--preset--color--background: #FFFFFF;--wp--preset--color--foreground-light: #6E6E6E;--wp--preset--color--foreground-dark: #020202;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 16.6px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 28.8px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--normal: 20px;--wp--preset--font-size--huge: 34.56px;--wp--preset--font-family--albert-sans: 'Albert Sans', sans-serif;--wp--preset--font-family--alegreya: Alegreya, serif;--wp--preset--font-family--arvo: Arvo, serif;--wp--preset--font-family--bodoni-moda: 'Bodoni Moda', serif;--wp--preset--font-family--bricolage-grotesque: 'Bricolage Grotesque', sans-serif;--wp--preset--font-family--cabin: Cabin, sans-serif;--wp--preset--font-family--chivo: Chivo, sans-serif;--wp--preset--font-family--commissioner: Commissioner, sans-serif;--wp--preset--font-family--cormorant: Cormorant, serif;--wp--preset--font-family--courier-prime: 'Courier Prime', monospace;--wp--preset--font-family--crimson-pro: 'Crimson Pro', serif;--wp--preset--font-family--dm-mono: 'DM Mono', monospace;--wp--preset--font-family--dm-sans: 'DM Sans', sans-serif;--wp--preset--font-family--dm-serif-display: 'DM Serif Display', serif;--wp--preset--font-family--domine: Domine, serif;--wp--preset--font-family--eb-garamond: 'EB Garamond', serif;--wp--preset--font-family--epilogue: Epilogue, sans-serif;--wp--preset--font-family--fahkwang: Fahkwang, sans-serif;--wp--preset--font-family--figtree: Figtree, sans-serif;--wp--preset--font-family--fira-sans: 'Fira Sans', sans-serif;--wp--preset--font-family--fjalla-one: 'Fjalla One', sans-serif;--wp--preset--font-family--fraunces: Fraunces, serif;--wp--preset--font-family--gabarito: Gabarito, system-ui;--wp--preset--font-family--ibm-plex-mono: 'IBM Plex Mono', monospace;--wp--preset--font-family--ibm-plex-sans: 'IBM Plex Sans', sans-serif;--wp--preset--font-family--ibarra-real-nova: 'Ibarra Real Nova', serif;--wp--preset--font-family--instrument-serif: 'Instrument Serif', serif;--wp--preset--font-family--inter: Inter, sans-serif;--wp--preset--font-family--josefin-sans: 'Josefin Sans', sans-serif;--wp--preset--font-family--jost: Jost, sans-serif;--wp--preset--font-family--libre-baskerville: 'Libre Baskerville', serif;--wp--preset--font-family--libre-franklin: 'Libre Franklin', sans-serif;--wp--preset--font-family--literata: Literata, serif;--wp--preset--font-family--lora: Lora, serif;--wp--preset--font-family--merriweather: Merriweather, serif;--wp--preset--font-family--montserrat: Montserrat, sans-serif;--wp--preset--font-family--newsreader: Newsreader, serif;--wp--preset--font-family--noto-sans-mono: 'Noto Sans Mono', sans-serif;--wp--preset--font-family--nunito: Nunito, sans-serif;--wp--preset--font-family--open-sans: 'Open Sans', sans-serif;--wp--preset--font-family--overpass: Overpass, sans-serif;--wp--preset--font-family--pt-serif: 'PT Serif', serif;--wp--preset--font-family--petrona: Petrona, serif;--wp--preset--font-family--piazzolla: Piazzolla, serif;--wp--preset--font-family--playfair-display: 'Playfair Display', serif;--wp--preset--font-family--plus-jakarta-sans: 'Plus Jakarta Sans', sans-serif;--wp--preset--font-family--poppins: Poppins, sans-serif;--wp--preset--font-family--raleway: Raleway, sans-serif;--wp--preset--font-family--roboto: Roboto, sans-serif;--wp--preset--font-family--roboto-slab: 'Roboto Slab', serif;--wp--preset--font-family--rubik: Rubik, sans-serif;--wp--preset--font-family--rufina: Rufina, serif;--wp--preset--font-family--sora: Sora, sans-serif;--wp--preset--font-family--source-sans-3: 'Source Sans 3', sans-serif;--wp--preset--font-family--source-serif-4: 'Source Serif 4', serif;--wp--preset--font-family--space-mono: 'Space Mono', monospace;--wp--preset--font-family--syne: Syne, sans-serif;--wp--preset--font-family--texturina: Texturina, serif;--wp--preset--font-family--urbanist: Urbanist, sans-serif;--wp--preset--font-family--work-sans: 'Work Sans', sans-serif;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}.is-layout-flow  > :first-child{margin-block-start: 0;}.is-layout-flow  > :last-child{margin-block-end: 0;}.is-layout-flow  > *{margin-block-start: 24px;margin-block-end: 0;}.is-layout-constrained  > :first-child{margin-block-start: 0;}.is-layout-constrained  > :last-child{margin-block-end: 0;}.is-layout-constrained  > *{margin-block-start: 24px;margin-block-end: 0;}.is-layout-flex {gap: 24px;}.is-layout-grid {gap: 24px;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-primary-color{color: var(--wp--preset--color--primary) !important;}.has-secondary-color{color: var(--wp--preset--color--secondary) !important;}.has-foreground-color{color: var(--wp--preset--color--foreground) !important;}.has-background-color{color: var(--wp--preset--color--background) !important;}.has-foreground-light-color{color: var(--wp--preset--color--foreground-light) !important;}.has-foreground-dark-color{color: var(--wp--preset--color--foreground-dark) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-primary-background-color{background-color: var(--wp--preset--color--primary) !important;}.has-secondary-background-color{background-color: var(--wp--preset--color--secondary) !important;}.has-foreground-background-color{background-color: var(--wp--preset--color--foreground) !important;}.has-background-background-color{background-color: var(--wp--preset--color--background) !important;}.has-foreground-light-background-color{background-color: var(--wp--preset--color--foreground-light) !important;}.has-foreground-dark-background-color{background-color: var(--wp--preset--color--foreground-dark) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-primary-border-color{border-color: var(--wp--preset--color--primary) !important;}.has-secondary-border-color{border-color: var(--wp--preset--color--secondary) !important;}.has-foreground-border-color{border-color: var(--wp--preset--color--foreground) !important;}.has-background-border-color{border-color: var(--wp--preset--color--background) !important;}.has-foreground-light-border-color{border-color: var(--wp--preset--color--foreground-light) !important;}.has-foreground-dark-border-color{border-color: var(--wp--preset--color--foreground-dark) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}.has-normal-font-size{font-size: var(--wp--preset--font-size--normal) !important;}.has-huge-font-size{font-size: var(--wp--preset--font-size--huge) !important;}.has-albert-sans-font-family{font-family: var(--wp--preset--font-family--albert-sans) !important;}.has-alegreya-font-family{font-family: var(--wp--preset--font-family--alegreya) !important;}.has-arvo-font-family{font-family: var(--wp--preset--font-family--arvo) !important;}.has-bodoni-moda-font-family{font-family: var(--wp--preset--font-family--bodoni-moda) !important;}.has-bricolage-grotesque-font-family{font-family: var(--wp--preset--font-family--bricolage-grotesque) !important;}.has-cabin-font-family{font-family: var(--wp--preset--font-family--cabin) !important;}.has-chivo-font-family{font-family: var(--wp--preset--font-family--chivo) !important;}.has-commissioner-font-family{font-family: var(--wp--preset--font-family--commissioner) !important;}.has-cormorant-font-family{font-family: var(--wp--preset--font-family--cormorant) !important;}.has-courier-prime-font-family{font-family: var(--wp--preset--font-family--courier-prime) !important;}.has-crimson-pro-font-family{font-family: var(--wp--preset--font-family--crimson-pro) !important;}.has-dm-mono-font-family{font-family: var(--wp--preset--font-family--dm-mono) !important;}.has-dm-sans-font-family{font-family: var(--wp--preset--font-family--dm-sans) !important;}.has-dm-serif-display-font-family{font-family: var(--wp--preset--font-family--dm-serif-display) !important;}.has-domine-font-family{font-family: var(--wp--preset--font-family--domine) !important;}.has-eb-garamond-font-family{font-family: var(--wp--preset--font-family--eb-garamond) !important;}.has-epilogue-font-family{font-family: var(--wp--preset--font-family--epilogue) !important;}.has-fahkwang-font-family{font-family: var(--wp--preset--font-family--fahkwang) !important;}.has-figtree-font-family{font-family: var(--wp--preset--font-family--figtree) !important;}.has-fira-sans-font-family{font-family: var(--wp--preset--font-family--fira-sans) !important;}.has-fjalla-one-font-family{font-family: var(--wp--preset--font-family--fjalla-one) !important;}.has-fraunces-font-family{font-family: var(--wp--preset--font-family--fraunces) !important;}.has-gabarito-font-family{font-family: var(--wp--preset--font-family--gabarito) !important;}.has-ibm-plex-mono-font-family{font-family: var(--wp--preset--font-family--ibm-plex-mono) !important;}.has-ibm-plex-sans-font-family{font-family: var(--wp--preset--font-family--ibm-plex-sans) !important;}.has-ibarra-real-nova-font-family{font-family: var(--wp--preset--font-family--ibarra-real-nova) !important;}.has-instrument-serif-font-family{font-family: var(--wp--preset--font-family--instrument-serif) !important;}.has-inter-font-family{font-family: var(--wp--preset--font-family--inter) !important;}.has-josefin-sans-font-family{font-family: var(--wp--preset--font-family--josefin-sans) !important;}.has-jost-font-family{font-family: var(--wp--preset--font-family--jost) !important;}.has-libre-baskerville-font-family{font-family: var(--wp--preset--font-family--libre-baskerville) !important;}.has-libre-franklin-font-family{font-family: var(--wp--preset--font-family--libre-franklin) !important;}.has-literata-font-family{font-family: var(--wp--preset--font-family--literata) !important;}.has-lora-font-family{font-family: var(--wp--preset--font-family--lora) !important;}.has-merriweather-font-family{font-family: var(--wp--preset--font-family--merriweather) !important;}.has-montserrat-font-family{font-family: var(--wp--preset--font-family--montserrat) !important;}.has-newsreader-font-family{font-family: var(--wp--preset--font-family--newsreader) !important;}.has-noto-sans-mono-font-family{font-family: var(--wp--preset--font-family--noto-sans-mono) !important;}.has-nunito-font-family{font-family: var(--wp--preset--font-family--nunito) !important;}.has-open-sans-font-family{font-family: var(--wp--preset--font-family--open-sans) !important;}.has-overpass-font-family{font-family: var(--wp--preset--font-family--overpass) !important;}.has-pt-serif-font-family{font-family: var(--wp--preset--font-family--pt-serif) !important;}.has-petrona-font-family{font-family: var(--wp--preset--font-family--petrona) !important;}.has-piazzolla-font-family{font-family: var(--wp--preset--font-family--piazzolla) !important;}.has-playfair-display-font-family{font-family: var(--wp--preset--font-family--playfair-display) !important;}.has-plus-jakarta-sans-font-family{font-family: var(--wp--preset--font-family--plus-jakarta-sans) !important;}.has-poppins-font-family{font-family: var(--wp--preset--font-family--poppins) !important;}.has-raleway-font-family{font-family: var(--wp--preset--font-family--raleway) !important;}.has-roboto-font-family{font-family: var(--wp--preset--font-family--roboto) !important;}.has-roboto-slab-font-family{font-family: var(--wp--preset--font-family--roboto-slab) !important;}.has-rubik-font-family{font-family: var(--wp--preset--font-family--rubik) !important;}.has-rufina-font-family{font-family: var(--wp--preset--font-family--rufina) !important;}.has-sora-font-family{font-family: var(--wp--preset--font-family--sora) !important;}.has-source-sans-3-font-family{font-family: var(--wp--preset--font-family--source-sans-3) !important;}.has-source-serif-4-font-family{font-family: var(--wp--preset--font-family--source-serif-4) !important;}.has-space-mono-font-family{font-family: var(--wp--preset--font-family--space-mono) !important;}.has-syne-font-family{font-family: var(--wp--preset--font-family--syne) !important;}.has-texturina-font-family{font-family: var(--wp--preset--font-family--texturina) !important;}.has-urbanist-font-family{font-family: var(--wp--preset--font-family--urbanist) !important;}.has-work-sans-font-family{font-family: var(--wp--preset--font-family--work-sans) !important;}
:root :where(.wp-block-button.is-style-outline .wp-block-button__link){background: transparent none;border-color: currentColor;border-width: 2px;border-style: solid;color: currentColor;padding-top: 0.667em;padding-right: 1.33em;padding-bottom: 0.667em;padding-left: 1.33em;}
:root :where(.wp-block-site-logo.is-style-rounded){border-radius: 9999px;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-10-1" href="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/saved_resource(6)" type="text/css" media="all">
<link crossorigin="anonymous" rel="stylesheet" id="print-css-11-1" href="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/print.css" type="text/css" media="print">
<link crossorigin="anonymous" rel="stylesheet" id="all-css-12-1" href="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/saved_resource(7)" type="text/css" media="all">
<link rel="stylesheet" id="exford-fonts-css" href="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/css" media="all">
<link crossorigin="anonymous" rel="stylesheet" id="all-css-14-1" href="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/style(1).css" type="text/css" media="all">
<style id="jetpack-global-styles-frontend-style-inline-css">
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-16-1" href="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/saved_resource(8)" type="text/css" media="all">
<script type="text/javascript" id="media-video-jwt-bridge-js-extra">
/* <![CDATA[ */
var videopressAjax = {"ajaxUrl":"https:\/\/bufferoverflowed.wordpress.com\/wp-admin\/admin-ajax.php","bridgeUrl":"\/wp-content\/mu-plugins\/jetpack-plugin\/moon\/jetpack_vendor\/automattic\/jetpack-videopress\/build\/lib\/token-bridge.js","post_id":"1200"};
/* ]]> */
</script>
<script type="text/javascript" id="wpcom-actionbar-placeholder-js-extra">
/* <![CDATA[ */
var actionbardata = {"siteID":"140701378","postID":"1200","siteURL":"http:\/\/bufferoverflowed.wordpress.com","xhrURL":"https:\/\/bufferoverflowed.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"2c82e20e22","isLoggedIn":"","statusMessage":"","subsEmailDefault":"instantly","proxyScriptUrl":"https:\/\/s0.wp.com\/wp-content\/js\/wpcom-proxy-request.js?ver=20211021","shortlink":"https:\/\/wp.me\/P9wmR4-jm","i18n":{"followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/read\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar"}};
/* ]]> */
</script>
<script crossorigin="anonymous" type="text/javascript" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/saved_resource(9)"></script>
<script type="text/javascript" id="rlt-proxy-js-after">
/* <![CDATA[ */
	rltInitialize( {"token":null,"iframeOrigins":["https:\/\/widgets.wp.com"]} );
/* ]]> */
</script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://bufferoverflowed.wordpress.com/xmlrpc.php?rsd">
<meta name="generator" content="WordPress.com">
<link rel="canonical" href="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/">
<link rel="shortlink" href="https://wp.me/P9wmR4-jm">
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Fbufferoverflowed.wordpress.com%2Fpractical-malware-analysis%2Fcovert-malware-launching%2Fpractical-malware-analysis-lab12-2%2F&amp;for=wpcom-auto-discovery"><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Fbufferoverflowed.wordpress.com%2Fpractical-malware-analysis%2Fcovert-malware-launching%2Fpractical-malware-analysis-lab12-2%2F&amp;for=wpcom-auto-discovery">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article">
<meta property="og:title" content="Practical Malware Analysis Lab12-2">
<meta property="og:url" content="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/">
<meta property="og:description" content="Analyze the malware found in the file Lab12-02.exe. Analysis: Let’s begin with Basic Static Analysis on Lab12-02.exe. Looking at the Imports, we can start to suspect some of the functionaliti…">
<meta property="article:published_time" content="2020-06-01T18:18:47+00:00">
<meta property="article:modified_time" content="2020-06-01T21:08:59+00:00">
<meta property="og:site_name" content="BufferOverflowed">
<meta property="og:image" content="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601173600843.png">
<meta property="og:image:width" content="905">
<meta property="og:image:height" content="265">
<meta property="og:image:alt" content="image-20200601173600843">
<meta property="og:locale" content="en_US">
<meta property="fb:app_id" content="249643311490">
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom">
<meta name="twitter:text:title" content="Practical Malware Analysis Lab12-2">
<meta name="twitter:image" content="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601173600843.png?w=640">
<meta name="twitter:image:alt" content="image-20200601173600843">
<meta name="twitter:card" content="summary_large_image">

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://s0.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48">
<link rel="icon" type="image/x-icon" href="https://s0.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48">
<link rel="apple-touch-icon" href="https://s0.wp.com/i/webclip.png">
<link rel="search" type="application/opensearchdescription+xml" href="https://bufferoverflowed.wordpress.com/osd.xml" title="BufferOverflowed">
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com">
<meta name="application-name" content="BufferOverflowed"><meta name="msapplication-window" content="width=device-width;height=device-height"><meta name="description" content="Analyze the malware found in the file Lab12-02.exe. Analysis: Let&#39;s begin with Basic Static Analysis on Lab12-02.exe. Looking at the Imports, we can start to suspect some of the functionalities of this Malware: The Malware may dynamically resolve and import external resources (GetProcAddress and LoadLibraryA) The Malware has the ability to create and terminate processes…">
<script type="text/javascript">
/* <![CDATA[ */
var wa_smart = { 'network_id': 3905, 'site_id': 474853, 'page_id': 1572546, 'blog_id': 140701378, 'post_id': null, 'theme': 'pub/exford', 'target': 'iab_category=IAB19-15;iab_category=IAB19;iab_category=IAB19-25;iab_category=IAB19-13;iab_category=IAB1-1;iab_category=IAB1;wp_blog_id=140701378;language=en;adflow=true', '_': { 'title': 'Advertisement', 'privacy_settings': 'Privacy Settings' }, 'inline': { 'format_id': 110354, 'max_slots': 20, 'max_blaze_slots': 20, 'enabled': false, 'adflow_enabled': true } }; wa_smart.cmd = [];
/* ]]> */
</script>
		<script type="text/javascript">
		function __ATA_CC() {var v = document.cookie.match('(^|;) ?personalized-ads-consent=([^;]*)(;|$)');return v ? 1 : 0;}
		var __ATA_PP = { 'pt': 2, 'ht': 0, 'tn': 'exford', 'uloggedin': 0, 'amp': false, 'consent': __ATA_CC(), 'gdpr_applies': false, 'ad': { 'label': { 'text': 'Advertisements' }, 'reportAd': { 'text': 'Report this ad' } }, 'disabled_slot_formats': [], 'siteid': 8982, 'blogid': 140701378 };
		var __ATA = __ATA || {};
		__ATA.cmd = __ATA.cmd || [];
		__ATA.criteo = __ATA.criteo || {};
		__ATA.criteo.cmd = __ATA.criteo.cmd || [];
		</script>
		<script type="text/javascript">
		(function(){var g=Date.now||function(){return+new Date};function h(a,b){a:{for(var c=a.length,d="string"==typeof a?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:"string"==typeof a?a.charAt(b):a[b]};function k(a,b,c){c=null!=c?"="+encodeURIComponent(String(c)):"";if(b+=c){c=a.indexOf("#");0>c&&(c=a.length);var d=a.indexOf("?");if(0>d||d>c){d=c;var e=""}else e=a.substring(d+1,c);a=[a.substr(0,d),e,a.substr(c)];c=a[1];a[1]=b?c?c+"&"+b:b:c;a=a[0]+(a[1]?"?"+a[1]:"")+a[2]}return a};var l=0;function m(a,b){var c=document.createElement("script");c.src=a;c.onload=function(){b&&b(void 0)};c.onerror=function(){b&&b("error")};a=document.getElementsByTagName("head");var d;a&&0!==a.length?d=a[0]:d=document.documentElement;d.appendChild(c)}function n(a){var b=void 0===b?document.cookie:b;return(b=h(b.split("; "),function(c){return-1!=c.indexOf(a+"=")}))?b.split("=")[1]:""}function p(a){return"string"==typeof a&&0<a.length}
		function r(a,b,c){b=void 0===b?"":b;c=void 0===c?".":c;var d=[];Object.keys(a).forEach(function(e){var f=a[e],q=typeof f;"object"==q&&null!=f||"function"==q?d.push(r(f,b+e+c)):null!==f&&void 0!==f&&(e=encodeURIComponent(b+e),d.push(e+"="+encodeURIComponent(f)))});return d.filter(p).join("&")}function t(a,b){a||((window.__ATA||{}).config=b.c,m(b.url))}var u=Math.floor(1E13*Math.random()),v=window.__ATA||{};window.__ATA=v;window.__ATA.cmd=v.cmd||[];v.rid=u;v.createdAt=g();var w=window.__ATA||{},x="s.pubmine.com";
		w&&w.serverDomain&&(x=w.serverDomain);var y="//"+x+"/conf",z=window.top===window,A=window.__ATA_PP&&window.__ATA_PP.gdpr_applies,B="boolean"===typeof A?Number(A):null,C=window.__ATA_PP||null,D=z?document.referrer?document.referrer:null:null,E=z?window.location.href:document.referrer?document.referrer:null,F,G=n("__ATA_tuuid");F=G?G:null;var H=window.innerWidth+"x"+window.innerHeight,I=n("usprivacy"),J=r({gdpr:B,pp:C,rid:u,src:D,ref:E,tuuid:F,vp:H,us_privacy:I?I:null},"",".");
		(function(a){var b=void 0===b?"cb":b;l++;var c="callback__"+g().toString(36)+"_"+l.toString(36);a=k(a,b,c);window[c]=function(d){t(void 0,d)};m(a,function(d){d&&t(d)})})(y+"?"+J);}).call(this);
		</script><script src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/conf"></script>	<script>
		var sas_fallback = sas_fallback || [];
		sas_fallback.push(
			{ tag: "&lt;div id=&quot;atatags-26942-667f95decc40c&quot;&gt;&lt;/div&gt;&lt;script&gt;__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: \'atatags-26942-667f95decc40c\',location: 120,formFactor: \'001\',label: {text: \'Advertisements\',},creative: {reportAd: {text: \'Report this ad\',},privacySettings: {text: \'Privacy\',}}});});&lt;/script&gt;", type: 'belowpost' },
			{ tag: "&lt;div id=&quot;atatags-26942-{{unique_id}}&quot;&gt;&lt;/div&gt;&lt;script&gt;__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: \'atatags-26942-{{unique_id}}\',location: 310,formFactor: \'001\',label: {text: \'Advertisements\',},creative: {reportAd: {text: \'Report this ad\',},privacySettings: {text: \'Privacy\',}}});});&lt;/script&gt;", type: 'inline' }
		);
	</script>		<script type="text/javascript">

			window.doNotSellCallback = function() {

				var linkElements = [
					'a[href="https://wordpress.com/?ref=footer_blog"]',
					'a[href="https://wordpress.com/?ref=footer_website"]',
					'a[href="https://wordpress.com/?ref=vertical_footer"]',
					'a[href^="https://wordpress.com/?ref=footer_segment_"]',
				].join(',');

				var dnsLink = document.createElement( 'a' );
				dnsLink.href = 'https://wordpress.com/advertising-program-optout/';
				dnsLink.classList.add( 'do-not-sell-link' );
				dnsLink.rel = 'nofollow';
				dnsLink.style.marginLeft = '0.5em';
				dnsLink.textContent = 'Do Not Sell or Share My Personal Information';

				var creditLinks = document.querySelectorAll( linkElements );

				if ( 0 === creditLinks.length ) {
					return false;
				}

				Array.prototype.forEach.call( creditLinks, function( el ) {
					el.insertAdjacentElement( 'afterend', dnsLink );
				});

				return true;
			};

		</script>
		<script type="text/javascript">
	window.google_analytics_uacct = "UA-52447-2";
</script>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-52447-2']);
	_gaq.push(['_gat._anonymizeIp']);
	_gaq.push(['_setDomainName', 'wordpress.com']);
	_gaq.push(['_initData']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})();
</script><script type="text/javascript" async="" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/ga.js.download"></script>
<script src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/smart.js.download"></script><script src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/wp-emoji-release.min.js.download" defer=""></script><link rel="stylesheet" id="gravatar-card-css" href="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/hovercards.min.css"><script src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/id5-api.js.download"></script><script src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/ata.js.download"></script><script src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/tag.js.download"></script><link href="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/actionbar.css" type="text/css" rel="stylesheet"></head>

<body class="page-template-default page page-id-1200 page-child parent-pageid-1160 wp-embed-responsive customizer-styles-applied singular image-filters-enabled hide-homepage-title jetpack-reblog-enabled">


<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/#content">Skip to content</a>

	
<header id="masthead" class="site-header responsive-max-width has-title-and-tagline has-menu" role="banner">
	<div class="site-branding">

								<p class="site-title"><a href="https://bufferoverflowed.wordpress.com/" rel="home">BufferOverflowed</a></p>
			
	</div><!-- .site-branding -->
		<nav id="site-navigation" class="main-navigation" aria-label="Main Navigation">

		<input type="checkbox" role="button" aria-haspopup="true" id="toggle" class="hide-visually">
		<label for="toggle" id="toggle-menu" class="button">
			Menu			<span class="dropdown-icon open">+</span>
			<span class="dropdown-icon close">×</span>
			<span class="hide-visually expanded-text">expanded</span>
			<span class="hide-visually collapsed-text">collapsed</span>
		</label>

		<div class="menu-menu-header-container"><ul id="menu-menu-header-1" class="main-menu" aria-label="submenu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50"><a href="https://bufferoverflowed.wordpress.com/">Home</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current-page-ancestor menu-item-has-children menu-item-748"><a href="https://bufferoverflowed.wordpress.com/practical-malware-analysis/" aria-haspopup="true" aria-expanded="false">Practical Malware Analysis</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-506"><a href="https://bufferoverflowed.wordpress.com/practical-malware-analysis/basic-static-analysis/">Chapter 1</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-525"><a href="https://bufferoverflowed.wordpress.com/practical-malware-analysis/basic-dynamic-analysis/">Chapter 3</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-593"><a href="https://bufferoverflowed.wordpress.com/practical-malware-analysis/ida-pro/">Chapter 5</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-694"><a href="https://bufferoverflowed.wordpress.com/practical-malware-analysis/c-code-constructs-in-assembly/">Chapter 6</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-808"><a href="https://bufferoverflowed.wordpress.com/practical-malware-analysis/analyzing-malicious-windows-programs/">Chapter 7</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-917"><a href="https://bufferoverflowed.wordpress.com/practical-malware-analysis/ollydbg/">Chapter 9</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1057"><a href="https://bufferoverflowed.wordpress.com/practical-malware-analysis/malware-behavior/">Chapter 11</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page current-page-ancestor menu-item-1191"><a href="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/">Chapter 12</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1306"><a href="https://bufferoverflowed.wordpress.com/data-encoding/">Chapter 13</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1638"><a href="https://bufferoverflowed.wordpress.com/malware-focused-network-signatures/">Chapter 14</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-497"><a href="https://bufferoverflowed.wordpress.com/slae32-slae/" aria-haspopup="true" aria-expanded="false">SLAE 32</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-76"><a href="https://bufferoverflowed.wordpress.com/slae32/slae-32-tcp-bind-shell/">SLAE 32 – Assignment 1</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-170"><a href="https://bufferoverflowed.wordpress.com/slae32/slae-32-tcp-rev-shell/">SLAE 32 – Assignment 2</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-191"><a href="https://bufferoverflowed.wordpress.com/slae32/slae-32-x86-egghunter/">SLAE 32 – Assignment 3</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-228"><a href="https://bufferoverflowed.wordpress.com/slae32/slae-32-shellcode-encoder/">SLAE 32 – Assignment 4</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-292"><a href="https://bufferoverflowed.wordpress.com/slae32/slae-32-shellcode-analysis/">SLAE 32 – Assignment 5</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-309"><a href="https://bufferoverflowed.wordpress.com/slae32/slae-32-polymorphing-shellcodes/">SLAE 32 – Assignment 6</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-346"><a href="https://bufferoverflowed.wordpress.com/slae32/slae-32-custom-crypter/">SLAE 32 – Assignment 7</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-1450"><a href="https://bufferoverflowed.wordpress.com/slae64/" aria-haspopup="true" aria-expanded="false">SLAE 64</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1451"><a href="https://bufferoverflowed.wordpress.com/slae64/tcp-bind-shell/">SLAE 64 – Assignment 1</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1503"><a href="https://bufferoverflowed.wordpress.com/slae64/tcp-rev-shell/">SLAE 64 – Assignment 2</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1517"><a href="https://bufferoverflowed.wordpress.com/slae64/egghunters/">SLAE 64 – Assignment 3</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1538"><a href="https://bufferoverflowed.wordpress.com/slae64/custom_encoder/">SLAE 64 – Assignment 4</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1560"><a href="https://bufferoverflowed.wordpress.com/slae64/shellcode_analysis/">SLAE 64 – Assignment 5</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1583"><a href="https://bufferoverflowed.wordpress.com/slae64/shellcode_polymorphism/">SLAE 64 – Assignment 6</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1595"><a href="https://bufferoverflowed.wordpress.com/slae64/shellcode_crypter/">SLAE 64 – Assignment 7</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-517"><a href="https://bufferoverflowed.wordpress.com/published-shellcodes/">Published Shellcodes</a></li>
</ul></div>	</nav><!-- #site-navigation -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">

	<section id="primary" class="content-area">
		<main id="main" class="site-main">

			
<article id="post-1200" class="post-1200 page type-page status-publish hentry entry">

	<header class="entry-header responsive-max-width">
		
<h1 class="entry-title">Practical Malware Analysis&nbsp;Lab12-2</h1>
	</header>

	
	<div class="entry-content">
		<p class="md-end-block md-p md-focus"><span class="md-plain md-expand">Analyze the malware found in the file Lab12-02.exe.</span></p>
<p class="md-end-block md-p"><span class=""><strong><span class="md-plain">Analysis:</span></strong></span></p>
<p class="md-end-block md-p"><span class="md-plain">Let’s begin with </span><span class=""><strong><span class="md-plain">Basic Static Analysis</span></strong></span><span class="md-plain"> on </span><span class=""><strong><span class="md-plain">Lab12-02.exe</span></strong></span><span class="md-plain">. Looking at the Imports, we can start to suspect some of the functionalities of this Malware:</span></p>
<ul class="ul-list">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">The Malware may dynamically resolve and import external resources (</span><span class=""><strong><span class="md-plain">GetProcAddress</span></strong></span><span class="md-plain"> and </span><span class=""><strong><span class="md-plain">LoadLibraryA</span></strong></span><span class="md-plain">)</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">The Malware has the ability to create and terminate processes (</span><span class=""><strong><span class="md-plain">CreateProcessA</span></strong></span><span class="md-plain">, and </span><span class=""><strong><span class="md-plain">TerminateProcess</span></strong></span><span class="md-plain">)</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">The Malware may allocate memory and use it in some fashion. (</span><span class=""><strong><span class="md-plain">VirtualAlloc</span></strong></span><span class="md-plain">, </span><span class=""><strong><span class="md-plain">HeapAlloc</span></strong></span><span class="md-plain">, </span><span class=""><strong><span class="md-plain">VirtualFree</span></strong></span><span class="md-plain">, </span><span class=""><strong><span class="md-plain">HeapFree</span></strong></span><span class="md-plain">, etc.)</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">The Malware will likely search and use a resource module (</span><span class=""><strong><span class="md-plain">FindResourceA</span></strong></span><span class="md-plain">, </span><span class=""><strong><span class="md-plain">SizeofResource</span></strong></span><span class="md-plain">, </span><span class=""><strong><span class="md-plain">LoadResource</span></strong></span><span class="md-plain">, and </span><span class=""><strong><span class="md-plain">LockResource</span></strong></span><span class="md-plain">)</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">The Malware can write and read files. (</span><span class=""><strong><span class="md-plain">WriteFile</span></strong></span><span class="md-plain">, and </span><span class=""><strong><span class="md-plain">ReadFile</span></strong></span><span class="md-plain">)</span></p>
</li>
</ul>
<ul class="ul-list">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">The Malware may read and write data to an area of memory in a specified process. (</span><span class=""><strong><span class="md-plain">WriteProcessMemory</span></strong></span><span class="md-plain">, and </span><span class=""><strong><span class="md-plain">ReadProcessMemory</span></strong></span><span class="md-plain">)</span></p>
</li>
</ul>
<ul class="ul-list">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">The Malware may retrieve and set the context of the specified thread. (</span><span class=""><strong><span class="md-plain">GetThreadContext</span></strong></span><span class="md-plain">, and </span><span class=""><strong><span class="md-plain">SetThreadContext</span></strong></span><span class="md-plain">)</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">The Malware has the ability to resume the execution of a Thread (</span><span class=""><strong><span class="md-plain">ResumeThread</span></strong></span><span class="md-plain">)</span></p>
</li>
</ul>
<p class="md-end-block md-p"><span class="md-plain">From the last imports mentioned we can start to guess that the Malware will use the </span><span class=""><strong><span class="md-plain">Process Replacement</span></strong></span><span class="md-plain"> technique.</span></p>
<p class="md-end-block md-p"><span class="md-plain">In terms of strings, this Malware has some interesting strings as well:</span></p>
<ul class="ul-list">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">The string </span><span class=""><strong><span class="md-plain"><span class="skimlinks-unlinked">svchost.exe</span></span></strong></span><span class="md-plain"> is highly suspicious. As it is a common process name, and with some of the Imports mentioned before, probably the Malware will attempt to inject on this process. </span></p>
</li>
</ul>
<p class="md-end-block md-p"><span class="md-plain">Looking at the resources, we can confirm that the Malware has indeed a resource named </span><span class=""><strong><span class="md-plain">LOCALIZATION</span></strong></span><span class="md-plain">.</span></p>
<p><img data-attachment-id="1202" data-permalink="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/image-20200601173600843/" data-orig-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601173600843.png" data-orig-size="905,265" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-20200601173600843" data-image-description="" data-image-caption="" data-medium-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601173600843.png?w=300" data-large-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601173600843.png?w=750" tabindex="0" role="button" class=" size-full wp-image-1202 aligncenter" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/image-20200601173600843.png" alt="image-20200601173600843" srcset="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601173600843.png 905w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601173600843.png?w=150&amp;h=44 150w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601173600843.png?w=300&amp;h=88 300w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601173600843.png?w=768&amp;h=225 768w" sizes="(max-width: 905px) 100vw, 905px"></p>
<p><span class="md-plain md-expand">Let’s move on to </span><span class=""><strong><span class="md-plain">Basic Dynamic Analysis</span></strong></span><span class="md-plain md-expand">. After running the Malware, and observing Process Explorer, we can see that it executes and creates an instance of <span class="skimlinks-unlinked">svchost.exe</span> and exists, leaving the <span class="skimlinks-unlinked">svchost.exe</span> process running as an orphaned process:</span></p>
<p><img data-attachment-id="1203" data-permalink="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/image-20200601171624658/" data-orig-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601171624658.png" data-orig-size="797,599" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-20200601171624658" data-image-description="" data-image-caption="" data-medium-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601171624658.png?w=300" data-large-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601171624658.png?w=750" tabindex="0" role="button" class=" size-full wp-image-1203 aligncenter" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/image-20200601171624658.png" alt="image-20200601171624658" srcset="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601171624658.png 797w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601171624658.png?w=150&amp;h=113 150w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601171624658.png?w=300&amp;h=225 300w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601171624658.png?w=768&amp;h=577 768w" sizes="(max-width: 797px) 100vw, 797px"></p>
<p>Even though an orphaned <strong><span class="skimlinks-unlinked">svchost.exe</span></strong> process is highly suspicious since this doesn’t stand out in Windows Task Manager, it’s normal that the process will blend in perfectly:</p>
<p><img data-attachment-id="1205" data-permalink="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/image-20200601172334520/" data-orig-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601172334520.png" data-orig-size="1201,562" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-20200601172334520" data-image-description="" data-image-caption="" data-medium-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601172334520.png?w=300" data-large-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601172334520.png?w=750" tabindex="0" role="button" class=" size-full wp-image-1205 aligncenter" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/image-20200601172334520.png" alt="image-20200601172334520" srcset="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601172334520.png 1201w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601172334520.png?w=150&amp;h=70 150w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601172334520.png?w=300&amp;h=140 300w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601172334520.png?w=768&amp;h=359 768w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601172334520.png?w=1024&amp;h=479 1024w" sizes="(max-width: 1201px) 100vw, 1201px"></p>
<p class="md-end-block md-p"><span class="md-plain">After executing Lab12-02.exe, in the same directory, a file named </span><span class=""><strong><span class="md-plain"><span class="skimlinks-unlinked">practicalmalwareanalysis.log</span></span></strong></span><span class="md-plain"> is created. By inspecting the file, we can see that the Malware has keylogging functionality.</span></p>
<p class="md-end-block md-p"><span class="md-plain">One interesting thing found in the information stored in </span><span class=""><strong><span class="md-plain"><span class="skimlinks-unlinked">practicalmalwareanalysis.log</span></span></strong></span><span class="md-plain"> is that special keys such as “[ENTER]” or “[TAB]” are well represented, even though these haven’t been observed Statically. This means that they probably come from the embedded resource (which has several strings but seem to be encoded). In the following image, we can see some of the mentioned strings in memory:</span></p>
<p><img data-attachment-id="1207" data-permalink="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/image-20200601173823177/" data-orig-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601173823177.png" data-orig-size="438,588" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-20200601173823177" data-image-description="" data-image-caption="" data-medium-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601173823177.png?w=223" data-large-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601173823177.png?w=438" tabindex="0" role="button" loading="lazy" class=" size-full wp-image-1207 aligncenter" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/image-20200601173823177.png" alt="image-20200601173823177" srcset="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601173823177.png 438w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601173823177.png?w=112&amp;h=150 112w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601173823177.png?w=223&amp;h=300 223w" sizes="(max-width: 438px) 100vw, 438px"></p>
<p class="md-end-block md-p"><span class="md-plain">Let’s advance to Advanced Static Analysis and Advanced Dynamic Analysis in order to understand better the Malware’s inner workings.</span></p>
<p class="md-end-block md-p md-focus"><span class="md-plain">After opening the file in IDA, we can see that the Malware starts by getting a module handle to itself (</span><span class=""><strong><span class="md-plain">GetModuleHandleA</span></strong></span><span class="md-plain">) and then calls </span><span class=""><strong><span class="md-plain">sub_40149D</span></strong></span><span class="md-plain"> where the string C:\Windows\system32\<span class="skimlinks-unlinked">svchost.exe</span> is created (</span><span class=""><strong><span class="md-plain">GetSystemDirectoryA</span></strong></span><span class="md-plain">, and the parameter “<span class="skimlinks-unlinked">svchost.exe</span>”):</span></p>
<p><img data-attachment-id="1209" data-permalink="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/image-20200601180506702/" data-orig-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601180506702.png" data-orig-size="374,290" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-20200601180506702" data-image-description="" data-image-caption="" data-medium-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601180506702.png?w=300" data-large-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601180506702.png?w=374" tabindex="0" role="button" loading="lazy" class=" size-full wp-image-1209 aligncenter" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/image-20200601180506702.png" alt="image-20200601180506702" srcset="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601180506702.png 374w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601180506702.png?w=150&amp;h=116 150w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601180506702.png?w=300&amp;h=233 300w" sizes="(max-width: 374px) 100vw, 374px"></p>
<p class="md-end-block md-p md-focus"><span class="md-plain">After that, </span><span class=""><strong><span class="md-plain">sub_40132C</span></strong></span><span class="md-plain md-expand"> is called. This function is where we can see a resource being loaded:</span></p>
<p><img data-attachment-id="1211" data-permalink="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/attachment/1544718723061/" data-orig-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544718723061.png" data-orig-size="729,641" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="1544718723061" data-image-description="" data-image-caption="" data-medium-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544718723061.png?w=300" data-large-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544718723061.png?w=729" tabindex="0" role="button" loading="lazy" class=" size-full wp-image-1211 aligncenter" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/1544718723061.png" alt="1544718723061" srcset="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544718723061.png 729w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544718723061.png?w=150&amp;h=132 150w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544718723061.png?w=300&amp;h=264 300w" sizes="(max-width: 729px) 100vw, 729px"></p>
<p><span class="md-plain md-expand">The space for the resource is being allocated with </span><span class=""><strong><span class="md-plain">VirtualAlloc</span></strong></span><span class="md-plain"> and then the content of the resource is being copied to that space with </span><span class=""><strong><span class="md-plain">memcpy</span></strong></span><span class="md-plain md-expand">:</span></p>
<p><img data-attachment-id="1212" data-permalink="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/attachment/1544719102941/" data-orig-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544719102941.png" data-orig-size="464,490" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="1544719102941" data-image-description="" data-image-caption="" data-medium-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544719102941.png?w=284" data-large-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544719102941.png?w=464" tabindex="0" role="button" loading="lazy" class=" size-full wp-image-1212 aligncenter" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/1544719102941.png" alt="1544719102941" srcset="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544719102941.png 464w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544719102941.png?w=142&amp;h=150 142w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544719102941.png?w=284&amp;h=300 284w" sizes="(max-width: 464px) 100vw, 464px"></p>
<p class="md-end-block md-p md-focus"><span class="md-plain">Then we have </span><span class="md-expand"><strong><span class="md-plain">sub_401000</span></strong></span><span class="md-plain">:</span></p>
<p><img data-attachment-id="1214" data-permalink="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/attachment/1544720365022/" data-orig-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544720365022.png" data-orig-size="335,184" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="1544720365022" data-image-description="" data-image-caption="" data-medium-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544720365022.png?w=300" data-large-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544720365022.png?w=335" tabindex="0" role="button" loading="lazy" class=" size-full wp-image-1214 aligncenter" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/1544720365022.png" alt="1544720365022" srcset="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544720365022.png 335w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544720365022.png?w=150&amp;h=82 150w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544720365022.png?w=300&amp;h=165 300w" sizes="(max-width: 335px) 100vw, 335px"></p>
<p>In this function, we can see a decode stub that is decoding the memory with a byte by byte XOR operation with the value “0x41 – A” (3rd parameter of the function).</p>
<p><img data-attachment-id="1215" data-permalink="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/attachment/1544720341567/" data-orig-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544720341567.png" data-orig-size="664,633" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="1544720341567" data-image-description="" data-image-caption="" data-medium-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544720341567.png?w=300" data-large-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544720341567.png?w=664" tabindex="0" role="button" loading="lazy" class=" size-full wp-image-1215 aligncenter" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/1544720341567.png" alt="1544720341567" srcset="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544720341567.png 664w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544720341567.png?w=150&amp;h=143 150w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544720341567.png?w=300&amp;h=286 300w" sizes="(max-width: 664px) 100vw, 664px"></p>
<p>In Olly we can actually see the buffer being decoded and identify a PE header:</p>
<p><img data-attachment-id="1217" data-permalink="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/attachment/1544724329177/" data-orig-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544724329177.png" data-orig-size="253,275" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="1544724329177" data-image-description="" data-image-caption="" data-medium-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544724329177.png?w=253" data-large-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544724329177.png?w=253" tabindex="0" role="button" loading="lazy" class=" size-full wp-image-1217 aligncenter" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/1544724329177.png" alt="1544724329177" srcset="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544724329177.png 253w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544724329177.png?w=138&amp;h=150 138w" sizes="(max-width: 253px) 100vw, 253px"></p>
<p class="md-end-block md-p"><span class="md-plain">After the loop finishes the decode, we can obtain the decoded payload by dumping that memory region to a file. Doing so, we obtain the following file:</span></p>
<ul class="ul-list">
<li class="md-list-item">
<p class="md-end-block md-p"><span class=""><strong><span class="md-plain">SHA256</span></strong></span><span class="md-plain">: 9b683d2fda7ca7adcc043e4412271009a0e115ca55f9a718c385a3f46b57ae6b</span></p>
</li>
</ul>
<p><img data-attachment-id="1218" data-permalink="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/image-20200601184222009/" data-orig-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601184222009.png" data-orig-size="959,483" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-20200601184222009" data-image-description="" data-image-caption="" data-medium-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601184222009.png?w=300" data-large-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601184222009.png?w=750" tabindex="0" role="button" loading="lazy" class=" size-full wp-image-1218 aligncenter" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/image-20200601184222009.png" alt="image-20200601184222009" srcset="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601184222009.png 959w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601184222009.png?w=150&amp;h=76 150w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601184222009.png?w=300&amp;h=151 300w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601184222009.png?w=768&amp;h=387 768w" sizes="(max-width: 959px) 100vw, 959px"></p>
<p class="md-end-block md-p md-focus"><span class="md-plain md-expand">We can also dump the Resource using Resource Hacker and then decode it with the following python script:</span></p>
<p><img data-attachment-id="1233" data-permalink="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/image-20200601191736714/" data-orig-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601191736714.png" data-orig-size="809,417" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-20200601191736714" data-image-description="" data-image-caption="" data-medium-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601191736714.png?w=300" data-large-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601191736714.png?w=750" tabindex="0" role="button" loading="lazy" class="alignnone size-full wp-image-1233" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/image-20200601191736714.png" alt="image-20200601191736714" srcset="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601191736714.png 809w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601191736714.png?w=150&amp;h=77 150w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601191736714.png?w=300&amp;h=155 300w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601191736714.png?w=768&amp;h=396 768w" sizes="(max-width: 809px) 100vw, 809px"></p>
<p class="md-end-block md-p md-focus"><span class="md-plain md-expand">The result will be the same.</span></p>
<p class="md-end-block md-p"><span class="md-plain">After decoding the file, it will free the Resource, copy the address to </span><span class=""><strong><span class="md-plain">EAX</span></strong></span><span class="md-plain"> and return:</span></p>
<p><img data-attachment-id="1223" data-permalink="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/attachment/1544720537903/" data-orig-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544720537903.png" data-orig-size="697,530" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="1544720537903" data-image-description="" data-image-caption="" data-medium-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544720537903.png?w=300" data-large-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544720537903.png?w=697" tabindex="0" role="button" loading="lazy" class=" size-full wp-image-1223 aligncenter" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/1544720537903.png" alt="1544720537903" srcset="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544720537903.png 697w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544720537903.png?w=150&amp;h=114 150w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544720537903.png?w=300&amp;h=228 300w" sizes="(max-width: 697px) 100vw, 697px"></p>
<p class="md-end-block md-p md-focus"><span class="md-plain md-expand">After the payload has been decoded, function </span><span class=""><strong><span class="md-plain">sub_4010EA</span></strong></span><span class="md-plain"> is called:</span></p>
<p><img data-attachment-id="1224" data-permalink="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/attachment/1544721840822/" data-orig-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544721840822.png" data-orig-size="405,206" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="1544721840822" data-image-description="" data-image-caption="" data-medium-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544721840822.png?w=300" data-large-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544721840822.png?w=405" tabindex="0" role="button" loading="lazy" class=" size-full wp-image-1224 aligncenter" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/1544721840822.png" alt="1544721840822" srcset="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544721840822.png 405w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544721840822.png?w=150&amp;h=76 150w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544721840822.png?w=300&amp;h=153 300w" sizes="(max-width: 405px) 100vw, 405px"></p>
<p><span class="md-plain md-expand">In this function an instance of </span><span class=""><strong><span class="md-plain"><span class="skimlinks-unlinked">svchost.exe</span></span></strong></span><span class="md-plain"> is created in suspended mode (</span><span class=""><strong><span class="md-plain">dwCreationFlags</span></strong></span><span class="md-plain"> = 4 (</span><span class=""><strong><span class="md-plain">CREATE_SUSPENDED</span></strong></span><span class="md-plain md-expand">)):</span></p>
<p><img data-attachment-id="1227" data-permalink="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/attachment/1544723485619/" data-orig-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544723485619.png" data-orig-size="368,166" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="1544723485619" data-image-description="" data-image-caption="" data-medium-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544723485619.png?w=300" data-large-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544723485619.png?w=368" tabindex="0" role="button" loading="lazy" class=" size-full wp-image-1227 aligncenter" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/1544723485619.png" alt="1544723485619" srcset="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544723485619.png 368w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544723485619.png?w=150&amp;h=68 150w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/1544723485619.png?w=300&amp;h=135 300w" sizes="(max-width: 368px) 100vw, 368px"></p>
<p class="md-end-block md-p md-focus"><span class="md-plain md-expand">If this function is successful, the Malware then dynamically loads </span><span class=""><strong><span class="md-plain">NtUnmapViewOfSection</span></strong></span><span class="md-plain"> in order to replace the target process’s memory with the malicious executable.</span></p>
<p><img data-attachment-id="1229" data-permalink="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/image-20200601182521866/" data-orig-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601182521866.png" data-orig-size="610,280" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-20200601182521866" data-image-description="" data-image-caption="" data-medium-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601182521866.png?w=300" data-large-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601182521866.png?w=610" tabindex="0" role="button" loading="lazy" class=" size-full wp-image-1229 aligncenter" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/image-20200601182521866.png" alt="image-20200601182521866" srcset="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601182521866.png 610w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601182521866.png?w=150&amp;h=69 150w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601182521866.png?w=300&amp;h=138 300w" sizes="(max-width: 610px) 100vw, 610px"></p>
<p><span class="md-plain md-expand">The Malware then allocates new memory and uses </span><span class=""><strong><span class="md-plain">WriteProcessMemory</span></strong></span><span class="md-plain md-expand"> in order to write each of the Malware’s sections to the target process memory space:</span></p>
<p><img data-attachment-id="1231" data-permalink="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/image-20200601182813793/" data-orig-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601182813793.png" data-orig-size="603,786" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-20200601182813793" data-image-description="" data-image-caption="" data-medium-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601182813793.png?w=230" data-large-file="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601182813793.png?w=603" tabindex="0" role="button" loading="lazy" class=" size-full wp-image-1231 aligncenter" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/image-20200601182813793.png" alt="image-20200601182813793" srcset="https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601182813793.png 603w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601182813793.png?w=115&amp;h=150 115w, https://bufferoverflowed.wordpress.com/wp-content/uploads/2020/06/image-20200601182813793.png?w=230&amp;h=300 230w" sizes="(max-width: 603px) 100vw, 603px"></p>
<p class="md-end-block md-p md-focus"><span class="md-plain">The Malware then restores the target process environment by calling SetThreadContext and resume execution of the Thread (that was suspended), thus initiating the Malware. With this, the newly created <span class="skimlinks-unlinked">svchost.exe</span> process has been replaced by the malicious payload that was decoded in memory.</span></p>
<p class="md-end-block md-p"><span class="md-plain">After finishing function </span><span class=""><strong><span class="md-plain">sub_4010EA</span></strong></span><span class="md-plain"> (which we can rename to process_replacement) the Malware frees up allocated memory and sleeps for 1 second before exiting.</span></p>
<p class="md-end-block md-p"><span class="md-plain">Thus, the Malware manages to load its malicious payload in the context of another process.</span></p>
<p class="md-end-block md-p"><span class=""><strong><span class="md-plain">Questions:</span></strong></span></p>
<p class="md-end-block md-p"><span class=""><strong><span class="md-plain">1) What is the purpose of this program?</span></strong></span></p>
<p class="md-end-block md-p"><span class="md-plain">The purpose of this Malware is to load a keylogger and disguise it as a <span class="skimlinks-unlinked">svchost.exe</span> process using Process Replacement.</span></p>
<p class="md-end-block md-p"><span class=""><strong><span class="md-plain">2) How does the launcher program hide execution?</span></strong></span></p>
<p class="md-end-block md-p"><span class="md-plain">It hides execution by performing </span><span class=""><strong><span class="md-plain">Process Replacement</span></strong></span><span class="md-plain"> on </span><span class=""><strong><span class="md-plain"><span class="skimlinks-unlinked">svchost.exe</span></span></strong></span><span class="md-plain">.</span></p>
<p class="md-end-block md-p"><span class=""><strong><span class="md-plain">3) Where is the malicious payload stored?</span></strong></span></p>
<p class="md-end-block md-p"><span class="md-plain">The malicious payload is stored in a resource named LOCALIZATION. This resource is an encoded executable file.</span></p>
<p class="md-end-block md-p"><span class=""><strong><span class="md-plain">4) How is the malicious payload protected?</span></strong></span></p>
<p class="md-end-block md-p"><span class="md-plain">The malicious payload is </span><span class=""><strong><span class="md-plain">XOR encoded</span></strong></span><span class="md-plain"> with the key value of 0x41 (A).</span></p>
<p class="md-end-block md-p"><span class=""><strong><span class="md-plain">5) How are strings protected?</span></strong></span></p>
<p class="md-end-block md-p"><span class="md-plain">The strings are XOR encoded. As we can see in </span><span class=""><strong><span class="md-plain">sub_401000</span></strong></span><span class="md-plain"> there is an XOR decode routine.</span></p>
<div id="atatags-370373-667f95dee4c9c">
		<script type="text/javascript">
			__ATA.cmd.push(function() {
				__ATA.initVideoSlot('atatags-370373-667f95dee4c9c', {
					sectionId: '370373',
					format: 'inread'
				});
			});
		</script>
	</div>			<div id="atatags-26942-667f95dee4e51" data-adtags-width="750"></div>
			
			<script>
				__ATA.cmd.push(function() {
					__ATA.initDynamicSlot({
						id: 'atatags-26942-667f95dee4e51',
						location: 120,
						formFactor: '001',
						label: {
							text: 'Advertisements',
						},
						creative: {
							reportAd: {
								text: 'Report this ad',
							},
							privacySettings: {
								text: 'Privacy',
								
							}
						}
					});
				});
			</script><div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul data-sharing-events-added="true"><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-1200" class="share-twitter sd-button share-icon" href="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/?share=twitter&amp;nb=1" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-1200" class="share-facebook sd-button share-icon" href="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/?share=facebook&amp;nb=1" target="_blank" title="Click to share on Facebook"><span>Facebook</span></a></li><li class="share-end"></li></ul></div></div></div><div class="sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-loaded" id="like-post-wrapper-140701378-1200-667f95dee5cfc" data-src="//widgets.wp.com/likes/index.html?ver=20240629#blog_id=140701378&amp;post_id=1200&amp;origin=bufferoverflowed.wordpress.com&amp;obj_id=140701378-1200-667f95dee5cfc" data-name="like-post-frame-140701378-1200-667f95dee5cfc" data-title="Like or Reblog"><div class="likes-widget-placeholder post-likes-widget-placeholder" style="height: 55px; display: none;"><span class="button"><span>Like</span></span> <span class="loading">Loading...</span></div><iframe class="post-likes-widget jetpack-likes-widget" name="like-post-frame-140701378-1200-667f95dee5cfc" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/index.html" height="55px" width="100%" frameborder="0" scrolling="no" title="Like or Reblog"></iframe><span class="sd-text-color"></span><a class="sd-link-color"></a></div></div>	</div><!-- .entry-content -->

	</article><!-- #post-1200 -->

		</main><!-- #main -->
	</section><!-- #primary -->


	</div><!-- #content -->

	
	<footer id="colophon" class="site-footer responsive-max-width">
			
	
		<div class="site-info">
		<a class="site-name" href="https://bufferoverflowed.wordpress.com/" rel="home">BufferOverflowed</a><span class="comma">,</span>
<a href="https://wordpress.com/?ref=footer_custom_svg" title="Create a website or blog at WordPress.com" rel="nofollow"><svg style="fill: currentColor; position: relative; top: 1px;" width="14px" height="15px" viewBox="0 0 14 15" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-labelledby="title" role="img">
				<desc id="title">Create a website or blog at WordPress.com</desc>
				<path d="M12.5225848,4.97949746 C13.0138466,5.87586309 13.2934037,6.90452431 13.2934037,7.99874074 C13.2934037,10.3205803 12.0351007,12.3476807 10.1640538,13.4385638 L12.0862862,7.88081544 C12.4453251,6.98296834 12.5648813,6.26504621 12.5648813,5.62667922 C12.5648813,5.39497674 12.549622,5.17994084 12.5225848,4.97949746 L12.5225848,4.97949746 Z M7.86730089,5.04801561 C8.24619178,5.02808979 8.58760099,4.98823815 8.58760099,4.98823815 C8.9267139,4.94809022 8.88671369,4.44972248 8.54745263,4.46957423 C8.54745263,4.46957423 7.52803983,4.54957381 6.86996227,4.54957381 C6.25158863,4.54957381 5.21247202,4.46957423 5.21247202,4.46957423 C4.87306282,4.44972248 4.83328483,4.96816418 5.17254589,4.98823815 C5.17254589,4.98823815 5.49358462,5.02808979 5.83269753,5.04801561 L6.81314716,7.73459399 L5.43565839,11.8651647 L3.14394256,5.04801561 C3.52312975,5.02808979 3.86416859,4.98823815 3.86416859,4.98823815 C4.20305928,4.94809022 4.16305906,4.44972248 3.82394616,4.46957423 C3.82394616,4.46957423 2.80475558,4.54957381 2.14660395,4.54957381 C2.02852925,4.54957381 1.88934333,4.54668493 1.74156477,4.54194422 C2.86690406,2.83350881 4.80113651,1.70529256 6.99996296,1.70529256 C8.638342,1.70529256 10.1302017,2.33173369 11.2498373,3.35765419 C11.222726,3.35602457 11.1962815,3.35261718 11.1683554,3.35261718 C10.5501299,3.35261718 10.1114609,3.89113285 10.1114609,4.46957423 C10.1114609,4.98823815 10.4107217,5.42705065 10.7296864,5.94564049 C10.969021,6.36482346 11.248578,6.90326506 11.248578,7.68133501 C11.248578,8.21992476 11.0413918,8.84503256 10.7696866,9.71584277 L10.1417574,11.8132391 L7.86730089,5.04801561 Z M6.99996296,14.2927074 C6.38218192,14.2927074 5.78595654,14.2021153 5.22195356,14.0362644 L7.11048207,8.54925635 L9.04486267,13.8491542 C9.05760348,13.8802652 9.07323319,13.9089317 9.08989995,13.9358945 C8.43574834,14.1661896 7.73285573,14.2927074 6.99996296,14.2927074 L6.99996296,14.2927074 Z M0.706448182,7.99874074 C0.706448182,7.08630113 0.902152921,6.22015756 1.25141403,5.43749503 L4.25357806,13.6627848 C2.15393732,12.6427902 0.706448182,10.4898387 0.706448182,7.99874074 L0.706448182,7.99874074 Z M6.99996296,0.999 C3.14016476,0.999 0,4.13905746 0,7.99874074 C0,11.8585722 3.14016476,14.999 6.99996296,14.999 C10.8596871,14.999 14,11.8585722 14,7.99874074 C14,4.13905746 10.8596871,0.999 6.99996296,0.999 L6.99996296,0.999 Z" id="wordpress-logo-simplified-cmyk" stroke="none" fill="“currentColor”" fill-rule="evenodd"></path>
			</svg></a>	</div><!-- .site-info -->
	</footer><!-- #colophon -->

</div><!-- #page -->

<!--  -->
<script type="text/javascript" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/hovercards.min.js.download" id="grofiles-cards-js"></script>
<script type="text/javascript" id="wpgroho-js-extra">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script crossorigin="anonymous" type="text/javascript" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/wpgroho.js.download"></script>

	<script>
		// Initialize and attach hovercards to all gravatars
		( function() {
			function init() {
				if ( typeof Gravatar === 'undefined' ) {
					return;
				}

				if ( typeof Gravatar.init !== 'function' ) {
					return;
				}

				Gravatar.profile_cb = function ( hash, id ) {
					WPGroHo.syncProfileData( hash, id );
				};

				Gravatar.my_hash = WPGroHo.my_hash;
				Gravatar.init(
					'body',
					'#wp-admin-bar-my-account',
					{
						i18n: {
							'Edit your profile': 'Edit your profile',
							'View profile': 'View profile',
							'Sorry, we are unable to load this Gravatar profile.': 'Sorry, we are unable to load this Gravatar profile.',
							'Too Many Requests.': 'Too Many Requests.',
							'Internal Server Error.': 'Internal Server Error.',
						},
					}
				);
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
	</script>

		<div style="display:none">
	</div>
		<!-- CCPA [start] -->
		<script type="text/javascript">
			( function () {

				var setupPrivacy = function() {

					// Minimal Mozilla Cookie library
					// https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie/Simple_document.cookie_framework
					var cookieLib = window.cookieLib = {getItem:function(e){return e&&decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,o,n,t,r,i){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var c="";if(n)switch(n.constructor){case Number:c=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:c="; expires="+n;break;case Date:c="; expires="+n.toUTCString()}return"rootDomain"!==r&&".rootDomain"!==r||(r=(".rootDomain"===r?".":"")+document.location.hostname.split(".").slice(-2).join(".")),document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(o)+c+(r?"; domain="+r:"")+(t?"; path="+t:"")+(i?"; secure":""),!0}};

					// Implement IAB USP API.
					window.__uspapi = function( command, version, callback ) {

						// Validate callback.
						if ( typeof callback !== 'function' ) {
							return;
						}

						// Validate the given command.
						if ( command !== 'getUSPData' || version !== 1 ) {
							callback( null, false );
							return;
						}

						// Check for GPC. If set, override any stored cookie.
						if ( navigator.globalPrivacyControl ) {
							callback( { version: 1, uspString: '1YYN' }, true );
							return;
						}

						// Check for cookie.
						var consent = cookieLib.getItem( 'usprivacy' );

						// Invalid cookie.
						if ( null === consent ) {
							callback( null, false );
							return;
						}

						// Everything checks out. Fire the provided callback with the consent data.
						callback( { version: 1, uspString: consent }, true );
					};

					// Initialization.
					document.addEventListener( 'DOMContentLoaded', function() {

						// Internal functions.
						var setDefaultOptInCookie = function() {
							var value = '1YNN';
							var domain = '.wordpress.com' === location.hostname.slice( -14 ) ? '.rootDomain' : location.hostname;
							cookieLib.setItem( 'usprivacy', value, 365 * 24 * 60 * 60, '/', domain );
						};

						var setDefaultOptOutCookie = function() {
							var value = '1YYN';
							var domain = '.wordpress.com' === location.hostname.slice( -14 ) ? '.rootDomain' : location.hostname;
							cookieLib.setItem( 'usprivacy', value, 24 * 60 * 60, '/', domain );
						};

						var setDefaultNotApplicableCookie = function() {
							var value = '1---';
							var domain = '.wordpress.com' === location.hostname.slice( -14 ) ? '.rootDomain' : location.hostname;
							cookieLib.setItem( 'usprivacy', value, 24 * 60 * 60, '/', domain );
						};

						var setCcpaAppliesCookie = function( applies ) {
							var domain = '.wordpress.com' === location.hostname.slice( -14 ) ? '.rootDomain' : location.hostname;
							cookieLib.setItem( 'ccpa_applies', applies, 24 * 60 * 60, '/', domain );
						}

						var maybeCallDoNotSellCallback = function() {
							if ( 'function' === typeof window.doNotSellCallback ) {
								return window.doNotSellCallback();
							}

							return false;
						}

						// Look for usprivacy cookie first.
						var usprivacyCookie = cookieLib.getItem( 'usprivacy' );

						// Found a usprivacy cookie.
						if ( null !== usprivacyCookie ) {

							// If the cookie indicates that CCPA does not apply, then bail.
							if ( '1---' === usprivacyCookie ) {
								return;
							}

							// CCPA applies, so call our callback to add Do Not Sell link to the page.
							maybeCallDoNotSellCallback();

							// We're all done, no more processing needed.
							return;
						}

						// We don't have a usprivacy cookie, so check to see if we have a CCPA applies cookie.
						var ccpaCookie = cookieLib.getItem( 'ccpa_applies' );

						// No CCPA applies cookie found, so we'll need to geolocate if this visitor is from California.
						// This needs to happen client side because we do not have region geo data in our $SERVER headers,
						// only country data -- therefore we can't vary cache on the region.
						if ( null === ccpaCookie ) {

							var request = new XMLHttpRequest();
							request.open( 'GET', 'https://public-api.wordpress.com/geo/', true );

							request.onreadystatechange = function () {
								if ( 4 === this.readyState ) {
									if ( 200 === this.status ) {

										// Got a geo response. Parse out the region data.
										var data = JSON.parse( this.response );
										var region      = data.region ? data.region.toLowerCase() : '';
										var ccpa_applies = ['california', 'colorado', 'connecticut', 'delaware', 'indiana', 'iowa', 'montana', 'new jersey', 'oregon', 'tennessee', 'texas', 'utah', 'virginia'].indexOf( region ) > -1;
										// Set CCPA applies cookie. This keeps us from having to make a geo request too frequently.
										setCcpaAppliesCookie( ccpa_applies );

										// Check if CCPA applies to set the proper usprivacy cookie.
										if ( ccpa_applies ) {
											if ( maybeCallDoNotSellCallback() ) {
												// Do Not Sell link added, so set default opt-in.
												setDefaultOptInCookie();
											} else {
												// Failed showing Do Not Sell link as required, so default to opt-OUT just to be safe.
												setDefaultOptOutCookie();
											}
										} else {
											// CCPA does not apply.
											setDefaultNotApplicableCookie();
										}
									} else {
										// Could not geo, so let's assume for now that CCPA applies to be safe.
										setCcpaAppliesCookie( true );
										if ( maybeCallDoNotSellCallback() ) {
											// Do Not Sell link added, so set default opt-in.
											setDefaultOptInCookie();
										} else {
											// Failed showing Do Not Sell link as required, so default to opt-OUT just to be safe.
											setDefaultOptOutCookie();
										}
									}
								}
							};

							// Send the geo request.
							request.send();
						} else {
							// We found a CCPA applies cookie.
							if ( ccpaCookie === 'true' ) {
								if ( maybeCallDoNotSellCallback() ) {
									// Do Not Sell link added, so set default opt-in.
									setDefaultOptInCookie();
								} else {
									// Failed showing Do Not Sell link as required, so default to opt-OUT just to be safe.
									setDefaultOptOutCookie();
								}
							} else {
								// CCPA does not apply.
								setDefaultNotApplicableCookie();
							}
						}
					} );
				};

				// Kickoff initialization.
				if ( window.defQueue && defQueue.isLOHP && defQueue.isLOHP === 2020 ) {
					defQueue.items.push( setupPrivacy );
				} else {
					setupPrivacy();
				}

			} )();
		</script>

		<!-- CCPA [end] -->
			<div id="actionbar" class="actnbr-pub-exford actnbr-has-follow actnbr-hidden">
		<ul>
						<li class="actnbr-ellipsis actnbr-hidden">
				<svg class="gridicon gridicons-ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M7 12c0 1.104-.896 2-2 2s-2-.896-2-2 .896-2 2-2 2 .896 2 2zm12-2c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm-7 0c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2z"></path></g></svg>				<div class="actnbr-popover tip tip-top-left actnbr-more">
					<div class="tip-arrow"></div>
					<div class="tip-inner">
						<ul>
									<li class="actnbr-sitename actnbr-hidden">
			<a href="https://bufferoverflowed.wordpress.com/">
				<img alt="" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/wpcom-gray-white.png" srcset="https://s0.wp.com/i/logo/wpcom-gray-white.png 1x" class="avatar avatar-50" height="50" width="50">				BufferOverflowed			</a>
		</li>
								<li class="actnbr-folded-customize actnbr-hidden">
								<a href="https://bufferoverflowed.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Fbufferoverflowed.wordpress.com%2Fpractical-malware-analysis%2Fcovert-malware-launching%2Fpractical-malware-analysis-lab12-2%2F">
									<svg class="gridicon gridicons-customize" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M2 6c0-1.505.78-3.08 2-4 0 .845.69 2 2 2 1.657 0 3 1.343 3 3 0 .386-.08.752-.212 1.09.74.594 1.476 1.19 2.19 1.81L8.9 11.98c-.62-.716-1.214-1.454-1.807-2.192C6.753 9.92 6.387 10 6 10c-2.21 0-4-1.79-4-4zm12.152 6.848l1.34-1.34c.607.304 1.283.492 2.008.492 2.485 0 4.5-2.015 4.5-4.5 0-.725-.188-1.4-.493-2.007L18 9l-2-2 3.507-3.507C18.9 3.188 18.225 3 17.5 3 15.015 3 13 5.015 13 7.5c0 .725.188 1.4.493 2.007L3 20l2 2 6.848-6.848c1.885 1.928 3.874 3.753 5.977 5.45l1.425 1.148 1.5-1.5-1.15-1.425c-1.695-2.103-3.52-4.092-5.448-5.977z"></path></g></svg>									<span>Customize</span>
								</a>
							</li>
																<li class="actnbr-signup actnbr-hidden"><a href="https://wordpress.com/start/">Sign up</a></li>
									<li class="actnbr-login actnbr-hidden"><a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fbufferoverflowed.wordpress.com%2Fpractical-malware-analysis%2Fcovert-malware-launching%2Fpractical-malware-analysis-lab12-2%2F&amp;signup_flow=account">Log in</a></li>
																	<li class="actnbr-shortlink actnbr-hidden"><a href="https://wp.me/P9wmR4-jm">Copy shortlink</a></li>
																	<li class="flb-report actnbr-hidden">
										<a href="https://wordpress.com/abuse/?report_url=https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/" target="_blank" rel="noopener noreferrer">
											Report this content										</a>
									</li>
																	<li class="actnbr-subs actnbr-hidden">
										<a href="https://subscribe.wordpress.com/">Manage subscriptions</a>
									</li>
														</ul>
					</div>
				</div>
			</li>
		</ul>
	</div>
	
<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20240115";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20231122";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

			<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions" itemscope="" itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"></path>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"></rect>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"></path>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"></rect>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"></path>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"></rect>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"></path>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>
							</span>
						</a>
												<a href="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"></path>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea name="comment" class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea" id="jp-carousel-comment-form-comment-field" placeholder="Write a Comment..."></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field">
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field">
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field">
															</fieldset>
																											</div>
													<input type="submit" name="submit" class="jp-carousel-comment-form-button" id="jp-carousel-comment-form-button-submit" value="Post Comment">
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" href="https://bufferoverflowed.wordpress.com/practical-malware-analysis/covert-malware-launching/practical-malware-analysis-lab12-2/#" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"></path>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/bufferoverflowed.wordpress.com\/practical-malware-analysis\/covert-malware-launching\/practical-malware-analysis-lab12-2\/":1200};
	</script>
				<link crossorigin="anonymous" rel="stylesheet" id="all-css-0-2" href="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/saved_resource(10)" type="text/css" media="all">
<script type="text/javascript" id="comment-like-js-extra">
/* <![CDATA[ */
var comment_like_text = {"loading":"Loading...","swipeUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/comment-likes\/js\/lib\/swipe.js?ver=20131008"};
/* ]]> */
</script>
<script type="text/javascript" id="jetpack-carousel-js-extra">
/* <![CDATA[ */
var jetpackSwiperLibraryPath = {"url":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/jetpack-plugin\/moon\/_inc\/build\/carousel\/swiper-bundle.min.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/bufferoverflowed.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"8e49492ead","display_exif":"1","display_comments":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/bufferoverflowed.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fbufferoverflowed.wordpress.com%2Fpractical-malware-analysis%2Fcovert-malware-launching%2Fpractical-malware-analysis-lab12-2%2F","blog_id":"140701378","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"stats_query_args":"blog=140701378&v=wpcom&tz=0&user_id=0&subd=bufferoverflowed","is_public":"1"};
/* ]]> */
</script>
<script type="text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script crossorigin="anonymous" type="text/javascript" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/saved_resource(11)"></script><div class="widget widget_eu_cookie_law_widget" style="display: block;">
<div class="hide-on-button ads-active" data-hide-timeout="30" data-consent-expiration="180" id="eu-cookie-law" style="display: block;">
	<form method="post">
		<input type="submit" value="Close and accept" class="accept">

		Privacy &amp; Cookies: This site uses cookies. By continuing to use this website, you agree to their use. <br>
To find out more, including how to control cookies, see here:
				<a href="https://automattic.com/cookies/" rel="nofollow">
			Cookie Policy		</a>
 </form>
</div>
</div>
<script type="text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>
	<script>
	/(trident|msie)/i.test(navigator.userAgent)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var t,e=location.hash.substring(1);/^[A-z0-9_-]+$/.test(e)&&(t=document.getElementById(e))&&(/^(?:a|select|input|button|textarea)$/i.test(t.tagName)||(t.tabIndex=-1),t.focus())},!1);
	</script>
	
	<script type="text/javascript">
		(function () {
			var wpcom_reblog = {
				source: 'toolbar',

				toggle_reblog_box_flair: function (obj_id, post_id) {

					// Go to site selector. This will redirect to their blog if they only have one.
					const postEndpoint = `https://wordpress.com/post`;

					// Ideally we would use the permalink here, but fortunately this will be replaced with the 
					// post permalink in the editor.
					const originalURL = `${ document.location.href }?page_id=${ post_id }`; 
					
					const url =
						postEndpoint +
						'?url=' +
						encodeURIComponent( originalURL ) +
						'&is_post_share=true' +
						'&v=5';

					const redirect = function () {
						if (
							! window.open( url, '_blank' )
						) {
							location.href = url;
						}
					};

					if ( /Firefox/.test( navigator.userAgent ) ) {
						setTimeout( redirect, 0 );
					} else {
						redirect();
					}
				},
			};

			window.wpcom_reblog = wpcom_reblog;
		})();
	</script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>	<iframe src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/master.html" scrolling="no" id="likes-master" name="likes-master" style="display:none;"></iframe>
	<div id="likes-other-gravatars" class="wpl-new-layout" role="dialog" aria-hidden="true" tabindex="-1" style="display: none;">
		<div class="likes-text">
			<span>%d</span>		</div>
		<ul class="wpl-avatars sd-like-gravatars"></ul>
	</div>

		<script src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/w.js.download" defer=""></script> <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'140701378','blog_tz':'0','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'140701378','v':'wpcom','tz':'0','user_id':'0','post':'1200','subd':'bufferoverflowed'}]);
		_stq.push(['extra', {'crypt':'UE5XaGUuOTlwaD85flAmcm1mcmZsaDhkV11YdWFnNncxc1tjZG9XVXhRU1I2fH5telcxaTdGUldPLzh+RElQaVZdJk5kXW0yS1V4ZCs0cCZmcU02Znl6cmFmeVAzclRDeDZzTC4vb2J5ZzRoR3ZmSHMsRz9fbmJIT1RTSSV0XUdjdWtbNVVfd3IleC9VWi8sJnU4d1EwQ0dEWXosPzJnJnE5T1dYYUdheFJJaFJnfkNsV0laeXdoLj9+YTZYSTN+dyVhU0clUnZsYUNsalNVZVh5cFpQVmZ0eEw4R0RQTVNdfDQlV2ZrWmRQQklpcW8tdltCZSxycHpKYUkycXV5VnM5YzBC'}]);
_stq.push([ 'clickTrackerInit', '140701378', '1200' ]);
</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:1px;width:1px;overflow:hidden;position:absolute;bottom:1px;" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>


<style>img#wpstats {
			position: absolute !important;
			clip: rect(0, 0, 0, 0);
			padding: 0 !important;
			border: 0 !important;
			height: 0 !important;
			width: 0 !important;
			overflow: hidden;
		}</style><img src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/g.gif" alt="" id="wpstats"><iframe name="__tcfapiLocator" style="display: none;" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/saved_resource(12).html"></iframe><div class="comment-likes-overlay" style="display: none;"></div><iframe style="display: none" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/101787.html"></iframe><div class="bottom-sticky__ad-container bottom-sticky__ad-container_hidden" id="bottom-sticky__ad-container" style="">
            <div class="bottom-sticky__ad-close-btn"></div>
            <div id="bottom-sticky-ad" style="margin:0 auto;width:728px;"></div>
        </div><style>.bottom-sticky__ad-container {
    background: #f1f1f1;
    position: fixed;
    left: 0;
    right: 0;
    bottom: 0;
    transform: translate(0,0);
    transition: transform .2s ease-in-out;
    user-select: none;
    padding-top: 10px;
    z-index: 49999;         /* AUTOMATTIC-2205 - because cookie consent banner has 50000 z-index */
}
.bottom-sticky__ad-container_hidden {
    visibility: hidden;
    transform: translate(0,1000px);
}
.bottom-sticky__ad-close-btn {
    width: 20px;
    height: 20px;
    position: absolute;
    box-sizing: content-box;
    border: 2px solid #9d9d9d;
    right: 2px;
    top: -14px;
    border-radius: 50%;
    background-color: #fff;
    cursor: pointer;
    overflow: hidden;
    background-size: 12px;
    background-repeat: no-repeat;
    background-position: center;
    background-image: url("data:image/svg+xml,%3Csvg width='24' height='24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath stroke-width='4' stroke='%239d9d9d' d='M0 0l24 24M0 24L24 0'/%3E%3C/svg%3E");
}
.bottom-sticky__ad-container .adtags-button {
    color: #000;
}</style><style>.ata-controls__complain-btn:hover,
.ata-controls__privacy-btn:hover {
    color: #666666 !important;
}
.ata-controls__complain-btn:active,
.ata-controls__privacy-btn:active {
    color: #5ac8fa !important;
}
.ata-controls__complain-btn_clicked,
.ata-controls__complain-btn_clicked:hover,
.ata-controls__complain-btn_clicked:active {
    color: #000 !important;
    cursor: default !important;
}
.ata-frame-wrapper {
    overflow: hidden;
    position: relative;
}
</style><script src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/725X1342.skimlinks.js.download"></script><script src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/actionbar.js.download" defer=""></script><iframe id="skimlinks-pixels-iframe" width="0" height="0" style="display: none;" src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/saved_resource(13).html"></iframe></body><iframe src="./Practical Malware Analysis Lab 12-2 – BufferOverflowed_files/topics_frame.html" style="display: none;"></iframe></html>